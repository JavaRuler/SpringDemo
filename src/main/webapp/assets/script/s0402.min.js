'use strict';
$(function() {

    // ================================ 变量声明 ================================ //
    // ContextPath
    var sContextPath = _.CONTEXT_PATH;
    // 机具信息一览表格
    var oDataTable;
    
    var nId = function() {
        if (location.pathname !== _.resolvePath(sContextPath, 'search/keyStatus')){
            var aslocatoin = location.pathname.split("/");
            // 获取 id
            return aslocatoin[aslocatoin.length - 1];
        }
    }();

    // ================================ 方法声明 ================================ //
    // JS插件渲染及画面初期事件绑定
    function initializePage() {
    	
    	

		var sUrl = _.resolvePath(sContextPath,'api/search/keyStatus',nId);
		$.get(sUrl).done(function(oData) {
					var hHtml = template("history-template", {list : oData.domainList, jyoutaiDoor:oData.jyoutaiDoor});
					$("#history-placeholder").html(hHtml);
				});

		// 刷新页面
		$('#refreshBtn').click(function() {
			var sUrl = _.resolvePath(sContextPath,'api/search/keyStatus',nId);
			$.get(sUrl).done(function(oData) {
						var hHtml = template("history-template", {list : oData.domainList, jyoutaiDoor:oData.jyoutaiDoor});
						$("#history-placeholder").html(hHtml);
					});

		});

		//反回上层
		$('#backBtn').click(function() {
			back();
		});

	}
   
	
			
	// 跳回一览画面
    function back(){
        _.route(_.resolvePath(sContextPath, 'search/deviceStatus'));
    }		

    // 画面初期化
    function onPageLoad() {
    	
    	
        // 画面初期事件绑定及JS插件渲染
        initializePage();
    }

    // ================================ 方法调用 ================================ //
    // 画面初期化
    onPageLoad();
});
