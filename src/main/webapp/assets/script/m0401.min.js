'use strict';
$(function() {

	$("#txtJE").get(0).focus();
    // ================================ 变量声明 ================================ //
    // ContextPath
    var sContextPath = _.CONTEXT_PATH;
    
  //获取id
    var path = function() {        
            var aslocatoin = location.pathname.split("/");
            // 获取 id
            return aslocatoin[aslocatoin.length - 1];
    }();
 
    // ================================ 方法声明 ================================ //
    // JS插件渲染及画面初期事件绑定
    function initializePage() {
       
    	 $('#updBtn').click(function() {
             // 验证失败,则返回
             if (!$('#passForm').valid()) {
                 return false;
             }

             // 提交至后台,根据url进行区分
             var sUrl = _.resolvePath(sContextPath, 'api/password'); 
             if ('password' != path){
            	 sUrl = _.resolvePath(sContextPath, 'api/devicepassword'); 
             }

             $.put(sUrl, $('#passForm').serializeJSON()).done(function() {
                 back();
             });
         })

         
      // VALIDATION 验证
         var oValidationOption = _.VALIDATION_OPTIONS;
         oValidationOption.rules = {
         	password: {
         		required: true,
         		
                 
             },
             
             password1: {
          		required: true,
          		equalTo: password
                  
              },
         };	

         $('#passForm').validate(oValidationOption);   
         
    }

    // 跳回一览画面
    function back(){

       _.route(_.resolvePath(sContextPath));

       
    }
    
    // 画面初期化
    function onPageLoad() {

        // 画面初期事件绑定及JS插件渲染
        initializePage();
    }

    // ================================ 方法调用 ================================ //
    // 画面初期化
    onPageLoad();
});
