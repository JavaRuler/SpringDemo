'use strict';
$(function () {

    // ================================ 变量声明 ================================ //
    // ContextPath
    var sContextPath = _.CONTEXT_PATH;

    // ================================ 方法声明 ================================ //
    // JS插件渲染及画面初期事件绑定
    function initializePage() {
        // JS插件渲染渲染
        // 什么都不做

        // 画面事件绑定
        // 登录按钮按下事件绑定
        $(document).keydown(function(event) { 
            if(event.keyCode == '13'){ //绑定回车 
                $('#login').click();
            } 
        }); 

        // 登录
        $('#login').click(function(event) {
            var ajaxOptions = {
                type: 'post',
                url: sContextPath + '/login',
                contentType: 'application/x-www-form-urlencoded',
                dataType: 'json',
                data: $('form').serializeObject(),
                success: function(data, textStatus, jqXHR) {
                    _.route(sContextPath + data.optionalUrl);
                },
                error: function(jqXHR, textStatus, errorThrown ) {
                    _.route(sContextPath + '/login');
                },
                complete: function(jqXHR, textStatus) {
                    
                }
            };
            $.ajax(ajaxOptions);
        });
    }

    // 画面初期化
    function onPageLoad() {

        // 画面初期事件绑定及JS插件渲染
        initializePage();
    }

    // ================================ 方法调用 ================================ //
    // 画面初期化
    onPageLoad();
});