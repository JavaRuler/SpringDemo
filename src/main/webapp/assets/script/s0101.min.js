'use strict';
$(function () {

    // ================================ 变量声明 ================================ //
    // ContextPath
    var sContextPath = _.CONTEXT_PATH;

    var oDataTable;
    
    $("#userName").get(0).focus();
    // ================================ 方法声明 ================================ //
    // JS插件渲染及画面初期事件绑定
    function initializePage() {
        // JS插件渲染渲染
        // 什么都不做

        var oDataTableOption = _.DATATABLES_OPTIONS;
        oDataTableOption.ajax = {
            url: _.resolvePath(sContextPath, 'api/historySearch'),
            data: function(oData) {
                $.extend(oData, $('form').serializeObject());
            }
        };

        oDataTableOption.columns = [ 
            {
                width: '10%',
                className: 'text-center',
                data: 'sousaDatetimeView'
            },
            {
                width: '10%',
                data: 'tenpoName'
            },            
            {
                width: '10%',
                data: 'userName'
            },            
            {
                width: '10%',
                className: 'text-center',
                data: 'kbsNo'
            },            
            {
                width: '10%',
                data: 'holderNo'
            },            
            {
                width: '10%',
                className: 'text-center',
                data: 'holderName'
            },
            {
                width: '10%',
                className: 'text-center',
                data: 'sousaShuName'
            }
      	]
      
      
     	$('.input-daterange-date input').each(function() {
	       	var oDatePickerOption = _.DATEPICKER_OPTIONS;
	       	oDatePickerOption.format = 'yyyy-mm-dd';
	   	  	$(this).datepicker(oDatePickerOption);
		   	  	 /*{
		   	  	
		   	  	todayBtn: "linked",
		   	  	 format:'yyyy-mm-dd',
		   	  	 language:'zh-CN',
		            keyboardNavigation: false,
		            forceParse: false,
		            calendarWeeks: true,
		            autoclose: true,
		            clearDates:true
		   	  }
		   	  );*/
	   	 	
	  	});
	  	
	  	
     	$('.input-daterange-time input').each(function() {
	       	var oTimepickerOptions = _.TIMEPICKER_OPTIONS;
	       	oTimepickerOptions.autoclose = true;
	       	oTimepickerOptions.todayHighlight = true;
	       	oTimepickerOptions.language = 'zh-CN';
	   	  	$(this).datetimepicker(oTimepickerOptions);
	   	 	
	  	});
        
	  	
      	// 获取初始化表格
        oDataTable = $('#historyTbl').DataTable(oDataTableOption);


        $('#searchBtn').click(function() {
            oDataTable.ajax.reload();
        });
        
        $('#clearBtn').click(function(){
        	$('#userName').clearFields();
        	$('#holderNo').clearFields();
        	$('#holderName').clearFields();
        	$('#kbsNo').clearFields();
        	$('#tenpoName').clearFields();
        	$('#sousaDatetimeStr').clearFields();
        	$('#sousaDatetimeEnd').clearFields();
        });
       
    }

    // 画面初期化
    function onPageLoad() {

        // 画面初期事件绑定及JS插件渲染
        initializePage();
    }

    // ================================ 方法调用 ================================ //
    // 画面初期化
    onPageLoad();
});